#!/usr/bin/env bash

set -x

BIN="$(realpath ${BASH_SOURCE%/*})"
# shellcheck disable=SC1090
source "${BIN}/schema_generator.sh"

MPS_ROOT=/app/mozilla-pipeline-schemas
# source for the schemas, for testing use something like master~5
mps_branch_source=${1:-$MPS_BRANCH_SOURCE}
# the branch to commit the bigquery schemas into
mps_branch_publish=${2:-$MPS_BRANCH_PUBLISH}
# the branch that is used to compare against the generated schemas
mps_branch_base=${3:-$mps_branch_publish}

validate_generate_commit \
    $MPS_ROOT \
    "$mps_branch_source" \
    "$mps_branch_publish" \
    "$mps_branch_base"
